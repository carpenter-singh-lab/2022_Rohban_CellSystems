Inspect PGC1a screen
================

``` r
library(magrittr)
library(tidyverse)
```

Trail that led me to the data

1.  [Paper](https://www.cell.com/cell/fulltext/S0092-8674(17)30249-0#secsectitle0075)
2.  [Project page](https://pubchem.ncbi.nlm.nih.gov/bioassay/651721)
3.  [Dataset within the
    project](https://pubchem.ncbi.nlm.nih.gov/bioassay/651723#section=Data-Table)

The “Download data table” and you get this URL below

``` r
screen <- read_csv("https://pubchem.ncbi.nlm.nih.gov/assay/pcget.cgi?query=download&record_type=datatable&actvty=all&response_type=save&aid=651723")
```

    ## 
    ## ── Column specification ───────────────────────────────────────────────────────────────────────────────────────────────────────────
    ## cols(
    ##   PUBCHEM_RESULT_TAG = col_character(),
    ##   PUBCHEM_SID = col_double(),
    ##   PUBCHEM_CID = col_double(),
    ##   PUBCHEM_ACTIVITY_OUTCOME = col_character(),
    ##   PUBCHEM_ACTIVITY_SCORE = col_double(),
    ##   PUBCHEM_ACTIVITY_URL = col_logical(),
    ##   PUBCHEM_ASSAYDATA_COMMENT = col_logical(),
    ##   REPRODUCIBILITY_COSINE_TRANSFORM = col_character(),
    ##   PCT_ACTIVE_REPLICATES = col_character(),
    ##   `REPLICATE_A_ACTIVITY_SCORE_15.56uM_(%)` = col_character(),
    ##   `REPLICATE_B_ACTIVITY_SCORE_15.56uM_(%)` = col_character()
    ## )

``` r
set.seed(42)
screen %>% 
  sample_n(10)
```

<div class="kable-table">

| PUBCHEM\_RESULT\_TAG | PUBCHEM\_SID | PUBCHEM\_CID | PUBCHEM\_ACTIVITY\_OUTCOME | PUBCHEM\_ACTIVITY\_SCORE | PUBCHEM\_ACTIVITY\_URL | PUBCHEM\_ASSAYDATA\_COMMENT | REPRODUCIBILITY\_COSINE\_TRANSFORM | PCT\_ACTIVE\_REPLICATES | REPLICATE\_A\_ACTIVITY\_SCORE\_15.56uM\_(%) | REPLICATE\_B\_ACTIVITY\_SCORE\_15.56uM\_(%) |
|:---------------------|-------------:|-------------:|:---------------------------|-------------------------:|:-----------------------|:----------------------------|:-----------------------------------|:------------------------|:--------------------------------------------|:--------------------------------------------|
| 61409                |     24840167 |      2576558 | Inactive                   |                        2 | NA                     | NA                          | 0.2147                             | 0                       | -6.83                                       | -6.279                                      |
| 54421                |     92763550 |     25604241 | Inactive                   |                      -10 | NA                     | NA                          | 0.955                              | 0                       | -7.545                                      | -14.348                                     |
| 99552                |      7975784 |      2913340 | Inactive                   |                       -6 | NA                     | NA                          | 0.6016                             | 0                       | 2.129                                       | -15.126                                     |
| 74358                |     49826609 |     24819407 | Inactive                   |                        5 | NA                     | NA                          | 0.9889                             | 0                       | 4.699                                       | 6.36                                        |
| 46204                |     57268526 |      4018760 | Inactive                   |                        0 | NA                     | NA                          | 0.0403                             | 0                       | -5.132                                      | 4.734                                       |
| 61601                |     17402696 |      1472482 | Inactive                   |                      -10 | NA                     | NA                          | 0.5923                             | 0                       | 6.878                                       | -6.448                                      |
| 335376               |    131433494 |     54637222 | Inactive                   |                       -5 | NA                     | NA                          | 0.7429                             | 0                       | -0.535                                      | -10.271                                     |
| 102254               |     14733067 |      3751368 | Inactive                   |                       -4 | NA                     | NA                          | 0.9704                             | 0                       | -3.242                                      | -5.392                                      |
| 62037                |       862980 |       664218 | Inactive                   |                       -2 | NA                     | NA                          | 0.3786                             | 0                       | 0.288                                       | 4.575                                       |
| 164768               |       853286 |       655938 | Inactive                   |                       -7 | NA                     | NA                          | 0.7523                             | 0                       | -13.733                                     | -0.911                                      |

</div>

``` r
screen %>%
  ggplot(aes(PUBCHEM_ACTIVITY_SCORE, fill = PUBCHEM_ACTIVITY_OUTCOME)) + 
  geom_histogram(bins = 100) + 
  theme(legend.position = "bottom")
```

    ## Warning: Removed 4 rows containing non-finite values (stat_bin).

![](1.inspect-pgc1a-screen_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
screen %>%
  ggplot(aes(PUBCHEM_ACTIVITY_OUTCOME, PUBCHEM_ACTIVITY_SCORE, )) + 
  geom_boxplot()
```

    ## Warning: Removed 4 rows containing non-finite values (stat_boxplot).

![](1.inspect-pgc1a-screen_files/figure-gfm/unnamed-chunk-4-2.png)<!-- -->

``` r
screen %>%
  count(PUBCHEM_ACTIVITY_OUTCOME)
```

<div class="kable-table">

| PUBCHEM\_ACTIVITY\_OUTCOME |      n |
|:---------------------------|-------:|
| Active                     |    741 |
| Inactive                   | 347966 |
| Inconclusive               |    388 |
| NA                         |      4 |

</div>
